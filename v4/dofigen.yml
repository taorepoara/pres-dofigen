context:
  - /pom.xml
  - /src/main/
builders:
  package:
    fromImage: maven:3.9-eclipse-temurin-17-alpine
    workdir: /app
    root:
      bind:
        - pom.xml
        - src
      run:
        - mvn package -DskipTests
        - mv target/*.jar app.jar
      cache:
        - /root/.m2
        - target
fromImage: eclipse-temurin:17-jre-alpine
copy:
  - fromBuilder: package
    paths: /app/app.jar
    target: app.jar
cmd: [ java, -jar, app.jar ]
