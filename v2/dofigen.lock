effective: |
  builders:
    package:
      fromImage:
        path: maven
        digest: sha256:a83a1692b72b4225a9c6357781b9fc1b4abce0abcb2fc5d715adb90372607b05
      copy:
      - paths:
        - .
      run:
      - mvn package -DskipTests
  fromImage:
    path: eclipse-temurin
    digest: sha256:31c3cc1b2b02ae43a3af8a34b0d4a20208818355b68f3112933f9e8fa5be9a3b
  copy:
  - fromBuilder: package
    paths:
    - target/*.jar
    target: app.jar
  cmd:
  - java
  - -jar
  - app.jar
images:
  registry.hub.docker.com:443:
    library:
      maven:
        3.9-eclipse-temurin-17-alpine:
          digest: sha256:a83a1692b72b4225a9c6357781b9fc1b4abce0abcb2fc5d715adb90372607b05
      eclipse-temurin:
        17-jre-alpine:
          digest: sha256:31c3cc1b2b02ae43a3af8a34b0d4a20208818355b68f3112933f9e8fa5be9a3b
resources:
  dofigen.yml:
    hash: eb3a04dc0036b251b17aa729481fc22ae6bc42f8041c50aa6c65516f44ad9aef
    content: |-
      builders:
        # Un builder qui va générer le JAR
        package:
          # Image Maven
          fromImage: maven:3.9-eclipse-temurin-17-alpine
          # Copie du projet
          copy: "."
          # Compilation du projet en un JAR
          run: mvn package -DskipTests
      # Image Java (JRE)
      fromImage: eclipse-temurin:17-jre-alpine
      # Copie du JAR généré
      copy:
        - fromBuilder: package
          paths: target/*.jar
          target: app.jar
      # Commande de démarrage
      cmd: [ java, -jar, app.jar ]
