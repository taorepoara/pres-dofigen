
## ProblÃ¨mes avec les Dockerfile ğŸ¤” .[steps sbs]


// En tant que dev, on a beaucoup de sujets Ã  traÃ®ter, les tests, la sÃ©curitÃ©, la performance, la lisibilitÃ©, la maintenabilitÃ©, etc.
// Et on a pas forcÃ©ment envie de passer du temps Ã  comprendre comment fonctionne la crÃ©ation de conteneurs pour dÃ©ployer nos projets.
// J'ai crÃ©Ã© Dofigen pour essayer de simplifier la crÃ©ation de Dockerfile et de rendre cette tÃ¢che plus accessible.

/*
dev: beaucoup de sujets Ã  traiter: tests, sÃ©curitÃ©, performance, maintenabilitÃ©, etc.
pas le temps et l'envie de comprendre les conteneurs

Sondage

Pour ceux qui ne savent pas
le layer: un niveau de construction d'une image. Ã©quivalent d'un commit dans un git
un stage: une image temporaire dans laquelle on peut faire des traÃ®tement dont le rÃ©sultat pourra Ãªtre copiÃ© dans l'image finale
*/

Le dev Ã  tout faire doit-il maÃ®triser l'Ã©criture de Dockerfile ?

- Qui est dÃ©veloppeur ?
- Qui a dÃ©jÃ  Ã©crit un Dockerfile ?
- Qui comprend les principe de layers et de stages dans Docker ?


/*
Next: ProblÃ¨mes que j'ai rencontrer avec les Dockerfile
Syntaxe des Dockerfile
*/

## Un nouveau "langage" Ã  apprendre ğŸ¤¯

Quand tu dÃ©cides de faire ton premier Dockerfile:

<img src="./bored-sigh.gif" style="width: 50vw;" />

/*
syntaxe en commandes

- pas envie, on dirait du Cobol
- pas simple d'analyser ou de modifier un Dockerfile via un script
*/

## Les Dockerfile sont souvent longs et complexes ğŸ“œ

Quand tu lis un Dockerfile pour la premiÃ¨re fois:

<img src="./theoffice-michael-scott.gif" style="width: 50vw;" />

/*
les layers et builders pas toujours bien compris

On s'y perd

Next: Une fois qu'on a rÃ©ussi Ã  crÃ©er son image Docker, on se rend compte qu'on a pas respectÃ© les bonnes pratiques pour l'envoyer en prod
*/

## Pas de "bonnes pratiques" par dÃ©faut ğŸ˜‘

Quand tu envoies en prod:

<img src="./silicon-valley-fire.gif" style="width: 50vw;" />

/*
root par dÃ©faut sur la plus part des images
.gitignore fonctionnent Ã  l'inverse selon moi

Next: Comment Dofigen tente de rÃ©pondre Ã  ces problÃ¨mes
*/

## Comment Dofigen tente de rÃ©pondre Ã  ces problÃ¨mes .[steps]

/*
Pour Lenra, on voulait une solution simple pour les devs de crÃ©er des images Docker pour la prod.
J'ai crÃ©Ã© Dofigen comme un projet Ã  part et qui est utilisÃ© comme dÃ©pendance du CLI de Lenra.

Dofigen: Docker file generator

- syntaxe: simple Ã  lire et Ã  Ã©crire + facile Ã  modifier via un script + facile de voir les stages
- layers: ordre des dÃ©finitions n'a pas d'importance (dans un mÃªme niveau) + Gestion de cache plus simple
- bonnes pratiques: rootless par dÃ©faut + `.dockerignore` dans le mÃªme fichier et peut Ãªtre dÃ©fini par ajout plutÃ´t que suppression
*/

- Syntaxe en YAML (ou JSON) ğŸ“
- Abstraction du concept de layers ğŸ“¦
- Bonnes pratiques par dÃ©faut ğŸ˜‡
